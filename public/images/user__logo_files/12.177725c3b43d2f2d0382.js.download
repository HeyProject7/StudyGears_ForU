(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{624:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n(1),c=n.n(a),s=(n(250),n(13),n(3),n(15),n(18),n(16),n(61),n(21),n(0)),o=n(6),r=n(4),d=n(39),l=n(8).UserHelpers.id(),u="tooltipFixed-"+(l||0),f=function(){var e;return null===(e=Object(s.c)(".tooltipFixed--otherlevels"))||void 0===e?void 0:e.remove()},m=function(){if(FEATURE_OTHERLEVELS_INBOX_TOOLTIP&&!o.a.getItem(u,"inbox")){var e,t,n=Object(s.c)(".tooltipFixed--otherlevels .tooltip__container");if(null==n||!n.classList.contains("tooltipFixed__active"))null===(e=Object(s.c)(".notification__close"))||void 0===e||e.addEventListener("click",f),null===(t=Object(s.c)(".button-close-forever"))||void 0===t||t.addEventListener("click",f),null==n||n.classList.add("tooltipFixed__active"),o.a.setItem(u,"inbox","1"),d.a.trackGAEventNoCache(["otherlevels",l,"onload","inbox"])}},g=n(109),v=(n(5),n(25),function(e){var t=new Date(b(e)),n=new Date,i=Number(n)-Number(t),a=Math.floor(i/1e3/60/60/24);i-=1e3*a*60*60*24;var c=Math.floor(i/1e3/60/60);i-=1e3*c*60*60;var s=Math.floor(i/1e3/60);i-=1e3*s*60;var o=Math.floor(i/1e3);return o<0||s<0||c<0||a<0?{secs:1,min:0,hours:0,days:0}:{secs:o,min:s,hours:c,days:a}}),b=function(e){var t=new Date(1e3*e),n=t.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];return t.getDate()+" "+i+" "+n+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},p=function(e){var t=1===e.time?0:1;return"%s "+({secs:["sec","secs"],min:["min","mins"],hours:["hour","hours"],days:["day","days"]}[e.units]||"min")[t]+" ago"},O=function(){Object(i.a)(c.a.mark((function e(){var t,i,a,d,l,u,b,O,h,L,j,M,k,_,E,w,T,y,C,N,S;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,i=!1,a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]"),d=Number(o.a.getItem("notification","lastUpdate")),e.next=6,Promise.all([n.e(139),n.e(54)]).then(n.bind(null,826));case 6:return e.next=8,e.sent;case 8:return l=e.sent,u=new l.OlNotifications("prod",(function(){})),e.next=12,n.e(109).then(n.t.bind(null,813,7));case 12:b=e.sent,O=b.default,"#notification-center-menu-trigger-units","#notification-center-menu-trigger","#notification-center-menu-trigger .icon","#notification-center-menu-side","#notification-center-menu-side-list",".notification-center-menu-side__card.-preview","#notification-center-menu-side-detail","#notification-center-menu-side-detail-content","#notification-center-menu-side-empty","#notification-center-menu-side__title-icon-close","#notification-center-menu-side-detail-controls-back","#notification-center-menu-side-detail-controls-remove",h=Object(s.c)("#notification-center-menu-side-empty"),L={messageCallbacks:function(e){t||(e.length&&o.a.setItem("notification","storedMessages",JSON.stringify(e)),S()),j(e,"#notification-center-menu-side-list"),N(".notification-center-menu-side__card.-preview")},newMessagesCallback:function(e){j(e,"#notification-center-menu-side-list"),N(".notification-center-menu-side__card.-preview")},updatedMessagesCallback:function(){},deletedMessagesCallback:function(){},metaCallback:function(e){M(e,"#notification-center-menu-trigger-units")}},u.initialize((function(){})),u.setTrackingId(gr.user.id,(function(){})),u.setMessageCallbacks(L.messageCallbacks,L.newMessagesCallback,L.updatedMessagesCallback,L.deletedMessagesCallback,L.metaCallback),j=function(e,n){if(0!==e.length){if(!t){h&&h.classList.add("-hidden");var i=e.map((function(e){var t,n,i=v(e.delivered_at),a=(t=i,n="secs",Object.keys(t).forEach((function(e){t[e]>0&&(n=e)})),{time:t[n],units:n}),c=p(a),s=Object(r.a)(c,a.time);return"1"===e.meta_data.show_tooltip&&m(),O({content:e.content,id:e.id,main_image:e.card_url,main_title:e.sline,phash:e.phash,read:e.read,timeString:s})})),a=Object(s.c)(n);a&&(a.innerHTML=i.join("")),t=!0}}else h&&!t&&h.classList.remove("-hidden")},M=function(e,t){var n=Object(s.c)(t);n&&(i||(e.unread?(n.innerHTML=e.unread.toString(),n.classList.add("-visible"),i=!0,E({filledTrigger:!0})):n.classList.remove("-visible")))},k=function(){var e=Object(s.c)("#notification-center-menu-trigger-units"),t=u.getCurrentMetaData(a).unread;e&&(t?e.innerHTML=String(t):e&&e.classList.remove("-visible"))},_=function(){var e=Object(s.c)("#notification-center-menu-side"),t=Object(s.d)(".notification.notify.notify--banner, .top-banner"),n=Object(s.c)("#navigation"),i=0;e&&t&&n&&(i=null==n?void 0:n.offsetHeight,null==t||t.map((function(e){i+=e.offsetHeight})),e.style.top=i+"px")},E=function(e){var t=e.openTrigger,n=e.filledTrigger,i=e.notificationsOpened,a=Object(s.c)("#notification-center-menu-trigger .icon"),c=t?i:!n;null==a||a.classList[c?"add":"remove"]("icon--notification"),null==a||a.classList[c?"remove":"add"]("icon--notification-filled")},w=function(){var e;Object(g.a)("bottom-right");var t=Object(s.c)("#notification-center-menu-side"),n="notifications-open"===document.body.dataset.trigger,i=Object(s.c)("#notification-center-menu-trigger-units");E({openTrigger:!0,notificationsOpened:n}),n?(u.getCurrentMetaData(a).unread?null==i||i.classList.add("-visible"):null==i||i.classList.remove("-visible"),null==t||t.classList.remove("-opened")):(u.getCurrentMetaData(a).unread&&(null==i||i.classList.remove("-visible")),null==t||t.classList.add("-opened")),f(),_(),null===(e=Object(s.c)("#notification-center-menu-trigger"))||void 0===e||e.classList.toggle("-opened"),document.body.dataset.trigger=n?"":"notifications-open",window.dispatchEvent(new Event("resize"))},T=function(e){var t,n=e.target,i=n.closest(".notification-center-menu-side__card.-preview"),c=Object(s.c)("#notification-center-menu-side-detail-content"),r=Object(s.c)("#notification-center-menu-side-list"),d=Object(s.c)("#notification-center-menu-side-detail-controls-back"),l=Object(s.c)("#notification-center-menu-side-detail-controls-remove"),f=Object(s.c)("#notification-center-menu-side-detail");a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]"),n.dataset.content?(t=n.dataset,n.classList.add("-read")):(t=i.dataset,i.classList.add("-read")),c&&(c.innerHTML=t.content),d&&(d.dataset.id=t.id),l&&(l.dataset.id=t.id),null==f||f.classList.remove("-hidden"),null==r||r.classList.add("-hidden"),u.setPhash(t.phash),u.markAsReadMessage(t.id),"0"!==n.dataset.read&&"0"!==i.dataset.read||(o.a.setItem("notification","storedMessages",JSON.stringify(u.markAsReadStoredMessage(a,Number(t.id)))),k())},y=function(){var e=Object(s.c)("#notification-center-menu-side-detail-content"),t=Object(s.c)("#notification-center-menu-side-detail"),n=Object(s.c)("#notification-center-menu-side-list");t&&t.classList.add("-hidden"),e&&(e.innerHTML=""),null==n||n.classList.remove("-hidden")},C=function(){var e=Object(s.c)("#notification-center-menu-side-detail-content"),n=Object(s.c)("#notification-center-menu-side-detail"),i=Object(s.c)("#notification-center-menu-side-list"),c=Object(s.c)("#notification-center-menu-side-detail-controls-remove");a=JSON.parse(o.a.getItem("notification","storedMessages")||"[]");var r=Number(null==c?void 0:c.dataset.id),d=null==c?void 0:c.dataset.phash,l=Object(s.c)('[data-id="'+r+'"]'),f=u.deleteStoredMessage(a,r);n&&n.classList.add("-hidden"),e&&(e.innerHTML=""),l&&l.remove(),d&&u.setPhash(d),u.deleteMessage(r),0===f.length?(t=!1,i&&(i.innerHTML="")):null==i||i.classList.remove("-hidden"),o.a.setItem("notification","storedMessages",JSON.stringify(f))},N=function(e){Object(s.d)(e).map((function(e){e.removeEventListener("click",T),e.addEventListener("click",T)}))},S=function(){var e,t,n,i;null===(e=Object(s.c)("#notification-center-menu-side-detail-controls-back"))||void 0===e||e.addEventListener("click",y),null===(t=Object(s.c)("#notification-center-menu-side-detail-controls-remove"))||void 0===t||t.addEventListener("click",C),null===(n=Object(s.c)("#notification-center-menu-trigger"))||void 0===n||n.addEventListener("click",w),null===(i=Object(s.c)("#notification-center-menu-side__title-icon-close"))||void 0===i||i.addEventListener("click",w)},function(){!d||d&&(v(d).min>=5||v(d).hours>=1||v(d).days>=1)?(u.getNewServerMessages(),o.a.setItem("notification","lastUpdate",String((new Date).getTime()/1e3))):(L.messageCallbacks(a),L.metaCallback(u.getCurrentMetaData(a)))}(),_();case 45:case"end":return e.stop()}}),e)})))()};FEATURE_OTHERLEVELS_ENABLED&&(gr.user?O():gr.addEventListener("gr:update:user",O))}}]);
//# sourceMappingURL=12.9c52ea6f60f9d206cca9d2c8e0d83faa.js.map